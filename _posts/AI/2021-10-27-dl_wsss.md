---
defaults:
  - scope:
      path: ""
      type: posts
    values:
      layout: single
      author_profile: true
      comments: true
      share: true
      related: true

title: "WSSS(Weakly Supervised Semantic Segmentation) ì†Œê°œ"
excerpt: "about : segmentation"
toc: true
toc_sticky: true
toc_label: "Label"
categories:
  - DL
tags:
  - [WSSS]
date: 2021-10-27
last_modified_at: 2021-10-27
---

<br>

# WSSS

- Weakly Supervised Semantic Segmentation
- segmentationë¥¼ ìˆ˜í–‰í• ë•Œ Pixel labelì´ ì—†ì„ê²½ìš°, image labelë‚˜ box labelë“±ì˜ ì•½í•œ Labelë¡œ segmentationì„ ìˆ˜í–‰í•˜ëŠ” Task
- í•„ìš”ì„± : pixel levelì˜ annotationì„ ì§„í–‰í• ë•Œ ê±¸ë¦¬ëŠ” ì‹œê°„ì´ ì¼ë°˜ image levelì˜ classificationì˜ 78ë°°ê°€ ê±¸ë¦¼

![image](https://user-images.githubusercontent.com/77658029/139003947-57c1bdfe-9757-4549-b9e4-01703376c5d2.png)

- Weak Supervision : Testì‹œì— ìš”êµ¬í•˜ëŠ” Output(pixel-level labels)ë³´ë‹¤ ê°„ë‹¨í•œ annotation(image, point level labels)ì„ ì´ìš©í•˜ì—¬ í•™ìŠµ

![image](https://user-images.githubusercontent.com/77658029/139004661-59c91f08-244e-4d98-b51c-820b2a2f3b6b.png)


## Naive approach

1. ì£¼ì–´ì§„ Image dataë¥¼ í™œìš©í•˜ì—¬ í•´ë‹¹ Dataì˜ label level ë‹¨ìœ„ì—ì„œ í•™ìŠµì§„í–‰(Classification, detection ..)

2. í•™ìŠµí•œ ëª¨ë¸ì—ì„œ CAM, Grad-CAM, Attentionì„ ì¶”ì¶œ

3. ì¶”ì¶œí•œ ê²°ê³¼ë¬¼ì—ì„œ imageì˜ pseudo maskë¥¼ ë½‘ì•„ë‚´ì–´ ëª¨ë¸ í•™ìŠµì— ì´ìš©

![image](https://user-images.githubusercontent.com/77658029/139004789-bb0f0b70-51a8-4a1f-9fa3-80c6d0cc763b.png)

**ğŸš¨ pseudo maskì˜ ê²°ê³¼ê°€ ì¢‹ì§€ ì•ŠìŒ**

## CAM ê¸°ë°˜ì˜ ì ‘ê·¼

### CAM & Grad-CAM

- CAM : Class Activation Mapping
- Classification ëª¨ë¸ì„ í•™ìŠµí•˜ë©´ì„œ ëª¨ë¸ì´ Classì˜ ë¬¼ì²´ê°€ ì–´ë–¤ ì˜ì—­ì„ ë°”ë¼ë³´ê³  ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ

![image](https://user-images.githubusercontent.com/77658029/139005652-d48e45a5-d6bf-496f-9684-c8e3deaa469f.png)

- CAM ì›ë¦¬
    - objectì˜ íŠ¹ì§•ì„ í‘œí˜„í•˜ëŠ” Feature mapì´ ì¡´ì¬í•¨
    - Scoringì‹œ ì´ëŸ° Feature map ì¤‘ objectë¥¼ êµ¬ë¶„í•˜ëŠ”ë° í•„ìš”í•œ íŠ¹ì§•ë“¤ì„ ëª¨ì•„ weightë¥¼ ë‹¤ë¥´ê²Œ ë¶€ì—¬í•˜ì—¬ Object ë¶„ë¥˜
    
![image](https://user-images.githubusercontent.com/77658029/139009383-87a6036c-5b88-41be-bc98-9862648aa4b5.png)

- CAMì˜ ë¬¸ì œì 
    - ë§ˆì§€ë§‰ LayerëŠ” GAP(í˜¹ì€ Flatten)ì‘ì—…ì´ í•„ìš”í•˜ì—¬, ì¼ë°˜ì ì¸ ì ìš©ì´ ë¶ˆê°€ëŠ¥
    - ë§ˆì§€ë§‰ Layerì—ì„œë§Œ CAMì„ ë½‘ì•„ë‚¼ ìˆ˜ ìˆê³ , ì´ì „ Layerì—ì„œëŠ” ì–´ë–»ê²Œ í™œì„±í™”ê°€ ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ì—†ìŒ


- Grad CAM
    - CAMì˜ ë¬¸ì œì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•œ ì‹œë„
    - CAMì—ì„œ feature mapì˜ GAPì˜ weightê°€ ì•„ë‹Œ, faetureì˜ ë³€í™”ì— ë”°ë¥¸ Class Scoreì˜ ë³€í™”
    - íŠ¹ì • feature mapì— ë³€í™”ê°€ ìˆì„ë•Œ Classì— scoreê°€ í¬ê²Œ ë³€í™”í•˜ë©´ ì¤‘ìš”ë„ê°€ ë†’ì€ feature map, class scoreê°€ ì‘ê²Œ ë³€í™”í•˜ë©´ ì¤‘ìš”ë„ê°€ ë‚®ì€ feature map
    - score ë³€í™”ëŸ‰ / feature map ë³€í™”ëŸ‰ = ê¸°ìš¸ê¸° = ë¯¸ë¶„ê°’ìœ¼ë¡œ ì¤‘ìš”ë„ ì •í•´ì§
    - GAPê°€ ì•„ë‹Œ feature map ëª¨ë“  ìœ„ì¹˜ì˜ ë¯¸ë¶„ê°’ í‰ê· ìœ¼ë¡œ weightë¥¼ êµ¬í•¨

![image](https://user-images.githubusercontent.com/77658029/139009492-bedaadbc-f6f7-469e-b97c-2019fea8600e.png)

![image](https://user-images.githubusercontent.com/77658029/139010427-63876892-995c-44ae-a00e-bb06dd34c153.png)

- CAM & Grad CAMì˜ ë¬¸ì œì 
    - ê²°ê³¼ê°€ Sharp í•˜ì§€ ì•Šê³ , ë­‰ê²Œì§€ê±°ë‚˜, ë‘¥ê¸€ë‘¥ê¸€í•œ ëª¨ì–‘ì„
    - ì…ë ¥ Imageì˜ í¬ê¸°ì™€ Feature mapì˜ í¬ê¸°ì˜ ì°¨ì´ë¡œ ì¸í•œ ë¬¸ì œ
    - í¬ê¸°ë¥¼ ë§ì¶°ì£¼ê¸° ìœ„í•´ upsamplingì„ ì§„í–‰í•˜ë©° ê´€ë ¨ ë¬¸ì œê°€ ë°œìƒí•¨
   

### CAMì„ Sharpí•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•œ ì ‘ê·¼

- ì…ë ¥ ì´ë¯¸ì§€ì™€ Feature mapì˜ í¬ê¸° ì°¨ì´ë¡œ ì¸í•´ì„œ upsampling ê³¼ì •ìœ¼ë¡œ ë™ê¸€ë™ê¸€í•œ í˜•íƒœë¡œ ì¶œë ¥ë˜ê²Œë¨

![image](https://user-images.githubusercontent.com/77658029/139012919-b89daf83-aa45-4911-bf07-b6b648378797.png)

#### 1. ë¬¼ì²´ í˜•íƒœ ì œê³µ

- ì˜ˆì¸¡í•œ Segmentation ì˜ì—­ì— CRFë¥¼ ì ìš©í•œ ê°’ê³¼ segmentationì˜ ì°¨ì´ ê°’ì„ boundary lossë¡œ í™œìš©í•˜ì—¬ í•™ìŠµ(model outputê³¼ CRF output ê°’ì´ ê°™ì•„ì§€ë„ë¡ KL Divergence lossë¥¼ ì‚¬ìš©)

![image](https://user-images.githubusercontent.com/77658029/139014393-f350fdec-e0eb-40a1-846d-447f9e02f77e.png)

#### 2. Transfer Learning

- MSRA10K saliency object datasetë¡œ í•™ìŠµí•œ Networkë¥¼ ì´ìš©
- ë½‘ì•„ë‚¸ CAMì˜ ê²°ê³¼ì™€ Saliency ì˜ˆì¸¡í•œ ê²°ê³¼ë¥¼ ì ì ˆí•˜ê²Œ í•©ì³ì„œ sharpí•œ ê²°ê³¼ë¥¼ ì–»ëŠ” ë°©ë²•
- Saliency ëœ»ì€ íŠ¹ì§•, ëŒì¶œì˜ ëœ»ì„ ê°€ì§€ê³  ìˆëŠ”ë°, Computer Visionì—ì„œëŠ” imageë¥¼ ë´¤ì„ë•Œ ì²˜ìŒ ë³´ì´ëŠ” objectë¥¼ ì˜ë¯¸í•¨, ê·¸ ì´ë¯¸ì§€ì˜ ì¤‘ì‹¬ì´ ë˜ëŠ” objectì™€ ë°°ê²½ ë‘ ê°€ì§€ë¡œ êµ¬ë¶„í•˜ëŠ” ë°©ì‹ì„ Saliencyë¼ê³  í•¨

![image](https://user-images.githubusercontent.com/77658029/139016205-ef5c8137-7f8a-4b24-bbae-b32913987102.png)

#### 3. Self -Supervised Learning

- ì…ë ¥ëœ ì´ë¯¸ì§€ì˜ í¬ê¸°ì— ë”°ë¼ CAMì´ ë‹¤ë¥¸ ë¶€ë¶„ì„ ê´€ì¸¡í•¨
- ì…ë ¥ëœ ì´ë¯¸ì§€ì˜ í¬ê¸°ì™€ ìƒê´€ì—†ì´ ê°™ì€ CAM ëª¨ì–‘ì„ ê°–ë„ë¡ í•™ìŠµ

![image](https://user-images.githubusercontent.com/77658029/139035534-9dc340b7-f776-4218-8472-62685e3ae721.png)

### CAM ì˜ì—­ í™•ì¥

- CAMì€ íŠ¹ì§•ì ì¸ ì˜ì—­ì—ë§Œ ì§‘ì¤‘í•˜ëŠ” ê²½í–¥ì´ ìˆì–´ ì˜ì—­ì´ ì¢ì•„ì§€ëŠ” ë¬¸ì œê°€ ìˆìŒ
- Classificationë“± ë‹¤ë¥¸ Taskë¥¼ í†µí•´ Segmentationì„ ê°„ì ‘ì ìœ¼ë¡œ í•™ìŠµí•˜ë‹¤ë³´ë©´, ë¬¼ì²´ë¥¼ ì •í™•í•˜ê²Œ êµ¬ë¶„í•´ì•¼í•  ì´ìœ ê°€ ì ìŒ
- í™•ì‹¤í•˜ê²Œ Classë¥¼ ì•Œ ìˆ˜ ìˆëŠ” íŠ¹ì§•ì— ì˜ì¡´í•˜ê²Œë¨

#### 1. íŠ¹ì§•ì ì¸ ì˜ì—­ Erase

- objectì˜ ì—¬ëŸ¬ê³³ì„ ë³¼ìˆ˜ ìˆë„ë¡ íŠ¹ì§•ì ì¸ ì˜ì—­ì„ ì§€ì›Œê°€ë©° ì§€ì† í•™ìŠµ
1. ì…ë ¥ ì´ë¯¸ì§€ CAM ì¶”ì¶œ
2. CAMì˜ ê²°ê³¼ ì˜ì—­ ì œê±° 
3. ë…ë¦½ì¸ ìƒˆë¡œìš´ ë„¤íŠ¸ì›Œí¬ë¡œ ì¬í•™ìŠµí•˜ì—¬ CAM ì¶”ì¶œ
4. ìœ„ ê³¼ì • ë°˜ë³µí•˜ì—¬ í•™ìŠµ ì§„í–‰

![image](https://user-images.githubusercontent.com/77658029/139037987-6d8c1fa8-0f32-4d67-9c78-7a95dc01f47d.png)

- ë‹¨ì 
    - ì—¬ëŸ¬ Networkê°€ í•„ìš”í•¨
    - Over-Erasing : ê³¼ë„í•˜ê²Œ ì§„í–‰ë˜ë©´ ë¬¼ì²´ê°€ ì•„ë‹Œ ì˜ì—­ê¹Œì§€ Maskê°€ ìƒê¸°ëŠ” í˜„ìƒì´ ìˆìŒ
![image](https://user-images.githubusercontent.com/77658029/139038912-d0c36cdd-c750-444d-b3cf-f4e5af8c8335.png)


#### 2. Patch Cutout

- ì´ë¯¸ì§€ì˜ Random ì˜ì—­ì„ patchë¥¼ ì§€ì›Œ ìµœëŒ€í•œ ë‹¤ì–‘í•œ ì˜ì—­ì—ì„œ íŠ¹ì§•ì„ ë½‘ì„ ìˆ˜ ë°–ì— ì—†ë„ë¡í•¨

![image](https://user-images.githubusercontent.com/77658029/139047072-0aa0e6b9-e925-4b3f-ac79-66f0753f8571.png)


#### 3. 1ë²ˆì„ í•˜ë‚˜ì˜ Networkë¡œ ìˆ˜í–‰

![image](https://user-images.githubusercontent.com/77658029/139048154-1d3aa667-ffba-43b5-94dd-4a07aa764cda.png)


#### 4. ë‹¤ì–‘í•œ Receptive Field ì‚¬ìš©

![image](https://user-images.githubusercontent.com/77658029/139048307-011fef08-a6ca-4d55-a12d-5c6a86d724db.png)

#### 5. Mixup

![image](https://user-images.githubusercontent.com/77658029/139048454-7bedd446-1e70-4b8e-9bc5-146851e9f79d.png)


<br><br>

**ğŸ“Œreference**
- boostcourse AI tech

<br>

```
ğŸ’¡ ìˆ˜ì • í•„ìš”í•œ ë‚´ìš©ì€ ëŒ“ê¸€ì´ë‚˜ ë©”ì¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!ğŸ’¡ 
```
