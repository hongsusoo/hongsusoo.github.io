---
defaults:
  - scope:
      path: ""
      type: posts
    values:
      layout: single
      author_profile: true
      comments: true
      share: true
      related: true

title: "AAE(Adversarial AutoEncoder) model ì†Œê°œ"
excerpt: "about : python"
toc: true
toc_sticky: true
toc_label: "Label"
categories:
  - DL
tags:
  - [DL, AAE]
date: 2021-08-10
last_modified_at: 2021-08-10
---

<br>

# AAE(Adversarial AutoEncoder)

- adversarial Auto EncoderëŠ” VAEì™€ GAN ë‘ ê°€ì§€ ëª¨ë¸ì„ ê²°í•©í•œ ëª¨ë¸

## AE(Auto Encoder)

- Auto EncoderëŠ” Encoderì™€ Decoderë¡œ êµ¬ì„±ë˜ì–´ ìˆìŒ
- Encoder : ì…ë ¥ì„ ë” ë‚®ì€ ì°¨ì› ë§Œë“¦
- Decoder : Encodingëœ ë°ì´í„°ë¥¼ ìµœëŒ€í•œ ì…ë ¥ì— ê°€ê¹ê²Œ ë””ì½”ë”©í•˜ê³  ì¬êµ¬ì„±í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•˜ëŠ”ìê°€ 
- ì••ì¶•ì— ì‚¬ìš©ë  ìˆ˜ ìˆì§€ë§Œ, ê·¸ëƒ¥ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì´ ë” íš¨ìœ¨ì ì´ì—¬ì„œ ì¸ê¸°ê°€ ì—†ìŒ
- ì‘ìš© ë¶„ì•¼ : noise filter(ì¡ìŒì œê±°), ì°¨ì›ê°ì†Œ, **ìƒˆë¡œìš´ ë°ì´í„° ìƒì„±**


**ğŸ’¡ AEë¥¼ í™œìš©í•œ ìƒˆ ë°ì´í„° ìƒì„±**

1. ë„í˜• 1,2,3ì„ encoding 
2. í•œ ë°ì´í„°ì—ì„œ ì•½ê°„ì˜ ë³€í˜•ì„ í•˜ì—¬ ìƒˆë¡œìš´ ë„í˜• 4ë¥¼ ë§Œë“¦
3. Decodingí•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìƒì„±í•¨

![image](https://user-images.githubusercontent.com/77658029/128884130-f618310d-764e-4f19-90b7-fa3a2e730574.png)

ğŸš¨ Issue ì‚¬í•­ : 2ë²ˆ ë‹¨ê³„ì—ì„œ ë³€í˜•ì— ëŒ€í•œ ììœ ë„ê°€ ë†’ì•„ í•´ì„ì´ ë¶ˆê°€ëŠ¥í•œ ì¶œë ¥ì´ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ

![image](https://user-images.githubusercontent.com/77658029/128885287-79a7569c-232b-445e-9b50-aafde76b31ac.png)

<br>

## VAE(Variational AutoEncoder)

- AEì˜ ì´ëŸ° Issue ì‚¬í•­ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ ì •ê·œí™”ë¥¼ ì§„í–‰í•˜ì—¬, ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì¤Œ
- ë‹¨ì¼ ì (ê²°ì •ì  ë°©ì‹)ì— ëŒ€í•œ ì…ë ¥ì´ ì•„ë‹Œ, ë¶„í¬(í™•ë¥ ì  ë°©ì‹)ë¥¼ ì…ë ¥ìœ¼ë¡œ í•˜ì—¬ ìµœëŒ€í•œ ì—°ì†ì ì¸ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì¤Œ

![image](https://user-images.githubusercontent.com/77658029/128886259-1c00e2c5-e3f8-4678-a477-02bc3f605a47.png)

![0_dwtvGrRWRAUJuZm4](https://user-images.githubusercontent.com/77658029/128886941-8f3e7be4-f620-4065-9574-fc5caac5aec4.gif)


<br>

### AE vs VAE

![image](https://user-images.githubusercontent.com/77658029/128891411-d22b460f-7140-4e28-9e5c-e61931fc467b.png)

<br>

### loss function

- VAEì˜ Losst functionì€ MSE(Mean Squared Error)ì™€ KL-divergence ë‘ ê°€ì§€ í•­ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŒ

![image](https://user-images.githubusercontent.com/77658029/128891648-f5611de7-bedd-4d0a-b1d5-1422808de95c.png)

![image](https://user-images.githubusercontent.com/77658029/128892086-00ea8561-7129-44c8-8cc8-77e76d21952e.png)

- MSEëŠ” ë‹¨ì¼ í•­ì— ëŒ€í•œ Lossë¥¼ ì¡ì•„ì¤Œ(AE)
- KL-divergenceëŠ” ë¶„í¬ì— ëŒ€í•œ Lossë¥¼ ì¡ì•„ì¤Œ(VAE)

-> ì›ë˜ëŠ” $p(z)$ì¸ë°, ì •ê·œë¶„í¬ì¸ $q(z|x)$ë¥¼ ì§€ì •í•´ì„œ, ê·¸ ì°¨ì´ë¥¼ Lossë¡œ ê°€ì ¸ê°

<br>

## GAN(Generative Adversarial Network)

- ì‹¬ì¸µ ìƒì„± ëª¨ë¸ë§ì˜ ì ‘ê·¼ë°©ì‹ ì¤‘ í•˜ë‚˜
- ì§€í ìœ„ì¡°ë²”ê³¼ ê²½ì°°ì´ì•¼ê¸°
- ì§€ë„í•™ìŠµê³¼ ë¹„ì§€ë„í•™ìŠµì˜ ê²°í•©(ê²½ì°°(Discriminator)ì€ ì§€ë„í•™ìŠµ, ìœ„ì¡°ë²”(generator)ì€ ë¹„ì§€ë„í•™ìŠµ)

í•œ ë²ˆì˜ epochì— ì¼ì–´ë‚˜ëŠ”ì¼ë“¤

1. Generator(ìœ„ì¡°ì§€íë²”ì´) ìœ„ì¡°ì§€íë¥¼ ë§Œë“ ë‹¤
2. Discriminator(ê²½ì°°) ì´ ìœ„ì¡°ì§€íì™€ ì‹¤ì œ ì§€íë¥¼ êµ¬ë¶„(ìœ„ì¡° - 0, ì§„ì§œ - 1)
3. í™•ë¥ ì´ 50% ì´ë©´ ì¢…ë£Œ(ì™„ë²½í•œ ìœ„ì¡°ì§€íê°€ ìƒì„±ë˜ë©´, í™•ë¥ ì€ 50í¼ê°€ ë  ê²ƒì„)

s
![image](https://user-images.githubusercontent.com/77658029/128894266-31f3473b-59d8-4cfe-88b3-e30a1583bb00.png)

-> Generatorì˜ ëª©ì ì€ D(G(z))ë¥¼ 1ë¡œ ë§Œë“¤ë ¤ê³  ë…¸ë ¥, DiscriminatorëŠ”  D(x)ëŠ” 1, D(G(z))ëŠ” 0ì„ ë§Œë“œëŠ”ê²Œ ëª©í‘œ

<br>


## AAE(Adversarial AutoEncoder)

- VAEì—ì„œëŠ” latent variablesë¥¼ íŠ¹ì •ë¶„í¬ë¡œ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•´ AEì™€ KL Divergenceë¥¼ ì‚¬ìš©
- AAEì—ì„œëŠ” KL Divergence ëŒ€ì‹ ì— GANë¥¼ í†µí•œ Discriminator Lossë¥¼ ì‚¬ìš©í•¨
- Discriminatorì—ì„œ ì§ì ‘ Aggregated Posteriorë¡œ Direct back propagation ì§„í–‰ë˜ì–´ encoder $p(z|x)$ë¥¼ ê°±ì‹ ì‹œì¼œì¤€ë‹¤
- encoder $p(z|x)$ê°€ ê°±ì‹ ë˜ë©´, ê²°êµ­ Aggregated Posteriorê°€ ë³€í•˜ê²Œ ë˜ê³  decoderë„ ë³€í•œìƒíƒœë¡œ ê²°ê³¼ê°€ ì¶œë ¥ë¨

![image](https://user-images.githubusercontent.com/77658029/128899926-20e277a5-43af-4334-b4e9-d30e1545898e.png)

![image](https://user-images.githubusercontent.com/77658029/128899609-cb3fd915-b42f-4dbf-9fee-271e98a74bd0.png)


<br>

ì¶”ê°€ í™•ì¸ í•„ìš”í•œ ë‚´ìš©
- encoding, decoding ë³€í™˜ì„ ì–´ë–»ê²Œ í•˜ëŠ”ì§€
- back propagationì´ ì–´ë–»ê²Œ ì ìš©ë˜ëŠ”ì§€?
- ê°ê°ì˜ networkë§ˆë‹¤ ì…ì¶œë ¥ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ 


**ğŸ“Œreference**
- boostcourse AI tech
- [toward data science](https://towardsdatascience.com/understanding-variational-autoencoders-vaes-f70510919f73)
- [ICHI.PRO](https://ichi.pro/ko/vae-variational-auto-encoder-leul-sayonghan-saengseong-modelling-277371603749134)
- [ICHI.PRO](https://ichi.pro/ko/aae-adversarial-auto-encoder-180304991426392)
- [EuleeKwon's Blog](https://m.blog.naver.com/euleekwon/221557899873)
- [YW & YY](https://greeksharifa.github.io/generative%20model/2020/08/23/AAE/)
- [í—¤í—¤](https://cumulu-s.tistory.com/26)

<br>

```
ğŸ’¡ ìˆ˜ì • í•„ìš”í•œ ë‚´ìš©ì€ ëŒ“ê¸€ì´ë‚˜ ë©”ì¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!ğŸ’¡ 
```
