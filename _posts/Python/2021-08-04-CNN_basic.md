---
defaults:
  - scope:
      path: ""
      type: posts
    values:
      layout: single
      author_profile: true
      comments: true
      share: true
      related: true

title: "[AI basic] í•©ì„±ê³± ì‹ ê²½ë§(CNN, Convolution Neural Network)"
excerpt: "about : python"
toc: true
toc_sticky: true
toc_label: "Label"
categories:
  - AI basic
tags:
  - [python, AI Math, Nerual Network, AI Model, CNN]
date: 2021-08-04
last_modified_at: 2021-08-04
---
<br>

# CNN

## CNN ìš©ì–´ ì„¤ëª…

### Convolution(í•©ì„±ê³±)


- CNNì—ì„œì˜ Convolutionì€ Kernel(filter)ëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  ë°ì´í„°ë¥¼ ì›€ì§ì´ë©° ê²¹ì¹˜ëŠ” ë¶€ë¶„ì„ ê³±í•´ì„œ ë”í•œëŠ”ê±¸ ì˜ë¯¸í•¨(ì—°ì†í•¨ìˆ˜ì˜ ê²½ìš°ëŠ” ì ë¶„)
- ìˆ˜ì‹ : $(f*g)(t)=\int _{{-\infty }}^{\infty }f(\tau )g(t-\tau )\,d\tau $

![convolution](https://user-images.githubusercontent.com/77658029/128343785-b787df24-2737-418f-96d1-3ed1e44890a5.gif)

### Kernel(Filter)

- ë°ì´í„°ì˜ íŠ¹ì„±ì„ ë½‘ê¸° ìœ„í•´ Filter ì‚¬ìš©í•¨, CNNì˜ í•™ìŠµì˜ ëŒ€ìƒì´ ë¨
- ì…€ì¹´ì°ì„ë•Œ ì–´ë–¤ íš¨ê³¼ë¥¼ ë„£ëŠ” ê·¸ í•„í„°

![image](https://user-images.githubusercontent.com/77658029/128345577-7e145408-ed13-482a-b378-dc0b3128b694.png)

### sobel filter ì†Œê°œ

![image](https://user-images.githubusercontent.com/77658029/128351126-714489ea-8224-452a-b6da-ba11af5807b1.png)


### ì•¡í‹°ë² ì´ì…˜ ë§µ(Activation Map, feature map)

- filter ì—°ì‚°ì˜ ê²°ê³¼ë¡œ ì´ë£¨ì–´ì§„ ì¶œë ¥ í–‰ë ¬

### ìŠ¤íŠ¸ë¼ì´ë“œ(Strid)

- kernelê³¼ ë°ì´í„°ë¥¼ convolutioní•˜ê³  ì´ë™í•˜ëŠ” ê±°ë¦¬
- ì•„ë˜ ê·¸ë¦¼ì€ strideê°€ 1ì¸ ê·¸ë¦¼ì´ê³ , ë§Œì•½ 2ë©´ ë‘ ì¹¸ì”© ì´ë™í•˜ì—¬ ê³±í•´ì§

![image](https://user-images.githubusercontent.com/77658029/128346187-e87a0eda-fd28-44ef-92a2-d1b00659e4de.png)

### íŒ¨ë”©(Padding)

- ê¸°ì¡´ ë°ì´í„°ì— kernelë¥¼ convolutioní•´ì¤„ ê²½ìš° ê²°ê³¼(feature map)ì˜ í¬ê¸°ëŠ” ì…ë ¥ë°ì´í„°ë³´ë‹¤ ì‘ì•„ì§
- ì´ëŸ° í˜„ìƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì›ë³¸ë°ì´í„° ì£¼ë³€ì— í”½ì…€ì„ ì¶”ê°€í•´ ì—°ì‚°ì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ëŸ° ì‘ì—…ì„ Paddingì´ë¼ê³  í•¨
- ëŒ€ë¶€ë¶„ 0ìœ¼ë¡œ ì±„ì›Œë„£ìŒ
- ì¶”ê°€í•˜ëŠ” í¬ê¸°ëŠ” kernelì˜ ì°¨ì›ì—ì„œ í•œ ì°¨ì› ëº€ í¬ê¸°ë§Œí¼ padding í•´ì¤Œ

ğŸ’¡ì…ë ¥ ë°ì´í„°(5x5), kernel í–‰ë ¬(3x3)ì„ í•©ì„±ê³±í•œ ê²°ê³¼ëŠ” 
(5(ì…ë ¥)-3(kernel)+1)ì°¨ì›ì˜ í–‰ë ¬ì´ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì— kernelì˜ ì°¨ì›ì—ì„œ í•œ ì°¨ì›ì„ ëº€ í¬ê¸°ë§Œí¼ feature mapì˜ í¬ê¸°ê°€ ì¤„ì–´ë“ ë‹¤

### í’€ë§(Sub sampling or Pooling)

- sub samplingì´ë¼ê³ ë„ í•˜ë©°, convolution layerë¥¼ ê±°ì³ ì¶”ì¶œëœ íŠ¹ì§•ì—ì„œ sampling(pooling)ì„ ê±°ì³ activation mapì„ ì¸ìœ„ì ìœ¼ë¡œ ì¤„ì—¬ì¤Œ
- max pooling, average pooling, L2-norm pooling ì¢…ë¥˜ê°€ ìˆìŒ


## Convolution ì—°ì‚°

- Convolution ì—°ì‚°ì€ kernelì„ ì…ë ¥ë²¡í„° ìƒì—ì„œ ì›€ì§ì—¬ ê°€ë©° ê³„ì‚°
- CNNì—ì„œì˜ Convolutionì€ Kernel(filter)ëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  ë°ì´í„°ë¥¼ ì›€ì§ì´ë©° ê²¹ì¹˜ëŠ” ë¶€ë¶„ì„ ê³±í•´ì„œ ë”í•œëŠ”ê±¸ ì˜ë¯¸í•¨(ì—°ì†í•¨ìˆ˜ì˜ ê²½ìš°ëŠ” ì ë¶„)
- ì‹ í˜¸(kernel)ë¥¼ ì´ìš©í•´ êµ­ì†Œì ìœ¼ë¡œ ì¦í­ ë˜ëŠ” ê°ì†Œì‹œì¼œ, íŠ¹ì§•ì„ ë½‘ì•„ë‚´ê±°ë‚˜ Filtering í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•¨
- ì—°ì‚° í›„ ì¶œë ¥ì˜ í¬ê¸° :
  ì…ë ¥í¬ê¸° : ($H,W$) / Kernal í¬ê¸° : ($K_H,K_W$) / ì¶œë ¥í¬ê¸° : ($O_H,O_W$)
  
  $O_H = H - K_H +1$
  
  $O_W = W - K_W +1$

### **ğŸ’¡convolution ìˆ˜ì‹**
![image](https://user-images.githubusercontent.com/77658029/128447299-c82e8083-6c8a-4d5d-8b4c-f9e19546524a.png)

### **ğŸ’¡ convolution ì—°ì‚°**

- Kernelì€ ì •ì˜ì—­ë‚´ì—ì„œ ì›€ì§ì´ì§€ë§Œ, ë³€í•˜ì§€ ì•Šê³ (translation invariant) ì£¼ì–´ì§„ ë°ì´í„°ì— êµ­ì†Œì (local)ìœ¼ë¡œ ì ìš©

![convolution](https://user-images.githubusercontent.com/77658029/128343785-b787df24-2737-418f-96d1-3ed1e44890a5.gif)

- íŒŒë€ìƒ‰ : ë°ì´í„°
- ë¹¨ê°„ìƒ‰ : kernel
- ê²€ì€ìƒ‰ : ê²°ê³¼ 
- ë…¸ë€ìƒ‰ : convolution ì—°ì‚°(ë„“ì´ê°€ ê²€ì€ìƒ‰ ê·¸ë˜í”„ë¡œ ê·¸ë ¤ì§)

### **ì°¨ì›ì— ë”°ë¥¸ Convolution**

![image](https://user-images.githubusercontent.com/77658029/128449300-1ec95814-368c-4291-989d-6ac0bc677d85.png)

- ì±„ë„ì´ ì—¬ëŸ¬ê°œì¸ 2ì°¨ì› ì…ë ¥ì˜ ê²½ìš°2ì°¨ì› Convolutionì„ ì±„ë„ ê°œìˆ˜ë§Œí¼ ì ìš©
- 3ì°¨ì› ì…ë ¥ë¶€í„°ëŠ” í–‰ë ¬ì´ ì•„ë‹Œ Tensorë¼ê³  ë¶€ë¦„

![image](https://user-images.githubusercontent.com/77658029/128450408-0c92de2d-38f7-4ebc-a1f2-a6b934334e13.png)

ğŸ’¡ ë§Œì•½ ì¶œë ¥ì˜ ì°¨ì›ì„ ì—¬ëŸ¬ê°œ ë§Œë“ ë‹¤ê³  í•˜ë©´ kernelë¥¼ ì—¬ëŸ¬ê°œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

![image](https://user-images.githubusercontent.com/77658029/128450705-7349de64-466c-43b9-b83f-b19f3010922a.png)


## CNN(Convolution Neural Network)

- ê¸°ì¡´ MLPì˜ ê²½ìš° ë°ì´í„° xì— ì°¨ì›ê³¼ ë™ì¼í•œ ì°¨ì›ì˜ í–‰ë²¡í„°ì˜ ì§‘í•©ìœ¼ë¡œ ê°€ì¤‘ì¹˜ í–‰ë ¬ì´ í•„ìš”
- CNNì—ì„œëŠ” kernelì„ ì…ë ¥ ë²¡í„° ìƒì—ì„œ ì›€ì§ì—¬ ê°€ë©° ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì— ë” ì‘ì€ í–‰ë ¬ë¡œ ê°€ëŠ¥í•¨

![image](https://user-images.githubusercontent.com/77658029/128445976-b8115400-d142-4902-b140-95b67d739e37.png)

- MLPëŠ” ì„ í˜• ëª¨ë¸ê³¼ í™œì„±í•¨ìˆ˜ë¡œ ëª¨ë‘ ì—°ê²°ëœ Fully connected êµ¬ì¡°
- CNNì€ ì´ì™€ ë‹¬ë¦¬ Kernelì„ ì…ë ¥ë²¡í„° ìƒì—ì„œ ì›€ì§ì—¬ ê°€ë©° ì„ í˜•ëª¨ë¸ê³¼ í•¨ì„±í•¨ìˆ˜ë¥¼ ì ìš©í•¨

![image](https://user-images.githubusercontent.com/77658029/128345577-7e145408-ed13-482a-b378-dc0b3128b694.png)


## Convolution ì—°ì‚°ì˜ ì—­ì „íŒŒ ì´í•´í•˜ê¸° 

- Convolution ì—°ì‚°ì€ Kernelì´ ëª¨ë“  ì…ë ¥ë°ì´í„°ì— ê³µí†µìœ¼ë¡œ ì ìš©, ì—­ì „íŒŒë¥¼ ê³„ì‚°í•  ë•Œë„ Convolution ì—°ì‚°ì´ ë‚˜ì˜¤ê²Œ ë¨

![image](https://user-images.githubusercontent.com/77658029/128450866-8bc6a9ec-60df-4dd5-bced-48485fe469ff.png)

![image](https://user-images.githubusercontent.com/77658029/128457007-cbcc4dc1-8a43-4698-bdd5-d8ea64689a34.png)

**ğŸ“Œreference**
- [TAEWAN.KIM ë¸”ë¡œê·¸](http://taewan.kim/post/cnn/)
- [í˜¸ë¡¤ë¦¬í•œ í•˜ë£¨](https://gruuuuu.github.io/machine-learning/cnn-doc/)
- [ë‡Œ ì™¸ì¥ í•˜ë“œ](https://wjrmffldrhrl.github.io/digital10/)
- [ì¡°ëŒ€í˜‘ì˜ ë¸”ë¡œê·¸](https://bcho.tistory.com/1149)


<br>
```
ğŸ’¡ ìˆ˜ì • í•„ìš”í•œ ë‚´ìš©ì€ ëŒ“ê¸€ì´ë‚˜ ë©”ì¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤!ğŸ’¡ 
```
